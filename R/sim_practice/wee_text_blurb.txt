  case nbinom2_family:
          s1 = log(mu_i(i)); // log(mu_i)
          s2 = 2. * s1 - ln_phi; // log(var - mu)
          jnll -= keep(i) * dnbinom_robust(y_i(i), s1, s2, true) * weights_i(i);
          break;

  case tweedie_family:
          s1 = invlogit(thetaf) + Type(1.0);
          jnll -= keep(i) * dtweedie(y_i(i), mu_i(i), exp(ln_phi), s1, true) * weights_i(i);
          break;